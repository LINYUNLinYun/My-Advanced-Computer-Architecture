# 高级计算机体系结构

## 1. 划重点

+ 计算机体系结构。Computer Architecture，一方面和芯片相关（微架构），一方面和性能相关（compile/runtime）。性能体现着DEP上，响应快节能性能好，D为时延Delay，E为Energy，P为product。**5、7、8章为重点。**
+ 芯片角度来讲，以前的芯片就是冯诺伊曼架构，存算分离。算如何提升性能？引入了并行，存这么存得好？引入memery hirachy（存储分级）。并行如何做？一是指令集并行，五级流水。然后讲内存，register、cache。然后讲内核core级别并行，然后再讲片上并行，最后讲datacenter。算得好唯一出路是并行。另一个是访存，从register到3-cache 到 DRAM 到 ssd/hdd。
+ Cahche、并行的章节都要考。如果再发展，会怎么样？Cache做的很好，Mem也做的很好，瓶颈在两者之间的数据流上。现在推崇近存计算，将存算核靠在一起，存类计算。再发展，就是吧并行的量变大，后面是类脑计算，从通用化变专用化。最后是量子计算和光子计算。
+ 前面的章节考一些小题目，567考的比较多
+ 选择、填空、判断、综合（menery hirachy）
+ arm是不精简指令集、复杂指令集、isa两项、几级流水功能、哪5级？
+ 并行：有几个冒险，有依赖存在，三种冒险，带来的影响，以及scoreboard算法思路，哪几个阶段，如何解决依赖问题，引入了计算重命名。考个小题，给个例题，scoreboard哪个周期要解决什么问题
+ 4分支预测：基本概念、基本事例、提升性能的3个方法、对冒险如何解决，VLIW等小概念
+ 5：那些缓存快、映射方式，如何映射、缓存的逻辑简答立体，**第5章是老师的研究重点**、有哪些局部性原则、缓存实效的3种形式、一致性管理、DRAM开销是怎么用。
+ 6:延迟3个部分，接口、
+ 7:如何做性能分析性能评估，CPI计算，利特尔定律如何做、动态功耗的评估，算一下A、f、平均功耗、有哪些仿真方法、全系统仿真等、工作负载设计有哪些、SPEC性能评估、习题。**第5、7章会考大题。**
+ 8:flynn架构划分方法、分布式架构长什么样子、几种常见架构区分、缓存一致性问题，如何宝座一致性、snooping协议例子怎么做、目录协议、
+ 9片上：并行细节、SMT影响、多核介绍、异构多核分类、多核重核区别
+ 10:数据中心，数据并行，单指令多数据等、向量处理器的时间计算、周期数VRM、
+ 11:片上网络、小概念、基本术语link、buff、特殊结构、Noc、互联拓扑、
+ 12：数据中心、小概念、功能、核心组件、层次化、能效比、电力系统组成、电力供给超额、削峰处理、冷却系统、思考问题

- 据说有出ppt上的例题，数字都没改、

## 2. 划重点

### 2.1 未知章节 指令级并行II

1. arm是不是精简指令集？是，广泛用于移动设备领域；x86是CISC，x86-64也就是x64是它的64位版本

2. RISC和CISC区别？
   - 精简指令集：指令简单、统一、能耗低、硬件设计简洁。
   - 复杂指令集：指令种类多、功能强大、但是硬件设计复杂。

3. ISA是什么？指令集架构是下层硬件与上层程序应用之间交互的规范接口。

4. 五级流水线有哪些？
   - IF：取指，CPU根据PC中的地址从指令内存中把下一条指令取出来。
   - ID：译码并从寄存器堆中读取源操作数，生成控制信号。
   - EX：执行指令，ALU干活
   - MA：访存，访问数据内存，只有load和store这两类指令在这一步要干活
   - WB：写回，把执行结果写回寄存器堆

5. 三种**冒险**是什么？几种冒险能分辨吗？

   数据依赖是指指令2要用到指令1的结果，所以得等指令1计算完成；结构依赖是指指令2其实和指令1没有数据依赖，但是两者用到同一个寄存器或内存地址，所以指令2 要等指令1读完才能写入；控制依赖是说指令3的执行取决于指令2是否跳转，所以指令3要等指令2的EX阶段结束才能取指。

   - RAW： 数据冒险，写后读，可能读到旧值。
   - WAR，WAW，结构依赖；导致读的读到了新值；导致写的旧值覆盖了新值。**冷知识，普通单流水线是没有WAR和WAW冒险的，有RAW。**
   - 

6. 所有算法的思路，怎么解决依赖问题？

   **可以通过数据转发（RAW），暂停指令等方法缓解流水线冒险。重命名缓解结构依赖、分支预测缓解控制依赖**

7. 新的算法引入了什么？

8. 什么scoreboard算法、tomasula算法等具体怎么实现的？

   - socreboard：四个阶段。用寄存器状态表和ALU操作数依赖表检查依赖关系。
     - 发送指令阶段：检查FU是否空闲、以及其他寄存器是否要写入同义寄存器，**排除WAW冒险**，**否则暂停指令发送**。记分牌是按序发射吗，如果上一条指令的发射阻塞了，那不能发送下一条，如果是阻塞在读操作数阶段那还是可以发射的         
     - 读操作数阶段：检查到没有数据依赖后，才开始读取数据，**排除RAW冒险**；即所有操作数就绪后才可以让FU执行指令，指令暂停。当收到广播说依赖的寄存器就绪了，恢复执行
     - 执行阶段：执行
     - 写回阶段：检测是否存在**WAR冒险**，有则暂停在WR阶段。
   - tomasulo：三个阶段。关键思路是换名，指令中的寄存器被实际数值或者指向保留站的指针代替，即**寄存器换名**，**缓解因为寄存器名字一致导致的结构冒险，但并没有完全消除结构冒险因为多个保留站仍可能竞争同一个FU**；保留站是说，一旦操作数就绪，立马获取并缓存操作数；能完成一些编译器不能完成的优化，因为编译器看到的寄存器名是有限个的。
     - 发送：
     - 执行
     - 写回

9. 以tomasula算法为例，给个例子给你，哪个周期要做什么操作要能够讲得出来。

10. 分支预测、超标量处理器？相关的概念要知道。这些基本概念基本示例都会考的。。

    - 超标量处理器就是说，一个周期发射多条指令，一个流水线级可以并行处理多个指令
    - 多发射处理器有两种，一种是VLIW，一种是超标量
    - 分支预测主要解决控制冒险，在分支跳转指令计算完成前，预测下一条发送的指令

11. 提升简单标量流水线性能有哪些方法？

    - 实现并行处理，如超标量流水线
    - 实现多样化，如为配置多组异构的FU（为乘除法这种较慢的多配置）；
    - 乱序执行+ROB

12. 分支预测这个冒险怎么解决的？分支目标缓冲器是？一些例子还是要看一下

    静态预测：编译时预测分支；动态预测运行时动态调整；需要分支历史表BHT，BTB分支目标缓冲器。它有两个字段，一个存储分支指令地址（用来判断当前指令是不是分支指令），一个存储分支目标地址，是预测的下一条地址

    预测错误：顺序处理器就清除分支流水线中的错误执行指令，乱序的就清楚ROB中错误的表项

### 2.2 第五章 缓存与主存

1. 内存的层次结构让你分析下，多少得分析出一点深度来吧？

   寄存器、L123缓存、主存、硬盘、磁盘

2. DRAM的缓慢增长成为拖累CPU性能的瓶颈，是怎么解决它的？而且还很快。

   - 在DRAM和寄存器之间引入多级缓存结构。SRAM
   - 预取技术
   - 乱序执行等

3. 缓存的逻辑结构映射方式是什么？有哪些？

   - 直接映射：n个行相当于有n个组，数据块只能放相应的地方
   - 全相连：n个行一个组，都可以放
   - 组相连：数据块只能放特定的组，但这个组里面的缓存行随便放

4. **缓存的逻辑结构——两道例题！**

5. 什么是缓存的失效三种形式？如何解决？

   - 强制失效：缓存预取？空间局部性
   - 容量失效
   - 冲突失效：引入缺失缓存和受害者缓存（基于时间局部性）

6. 缓存的一致性 

7. DRAM的基础，长什么样子？让你画你应该画得出来，或者填空。

### 2.3 第五第六章是老师考察的重点

1. **局部性原则是什么？（老师的研究方向）**该怎么解决？

   时间局部性和空间局部性：时间局部性是说，访问过了的还会再访问，重复访问一个数据；空间局部性是说，程序会倾向于访问相邻的内存

2. 访问DRAM、存储的开销——如何衡量、计算？

### 2.4 第六章 数据存储

考大题不多，考一些小概念

1. **访问延迟的三个部分分别是？**

   - 寻道时间：磁头定位到正确磁道的用时
   - 旋转延迟：正确扇区旋转到磁头的用时
   - 数据传输时间：读取数据的时间 

2. 接口有哪些？

   - ATA：advanced tech attachment高级技术附件如PATA，SATA串行高级技术附件
   - 小型计算机系统接口：SCSI，small computer sys interface 基于ATA改进
   - 光纤 fibre channel 

3. 概念看一下。

4. 有哪些策略？JBOD RAID廉价硬盘冗余阵列（数据条带化和数据镜像）

   raid0 无冗余，单纯条带化

   raid1 双倍raid0，双倍开销

   raid10 镜像的条带化  2*3 1/5

   raid01 条带化的镜像 3*2 3/5

5. 什么是磁盘阵列?

   因为单个磁盘访问速度太低了，于是有了阵列

   

### 2.5 第七章 性能分析与评估

1. 如何做性能分析性能评估，CPI计算

   <img src="C:\Users\18289\AppData\Roaming\Typora\typora-user-images\image-20260115114903384.png" alt="image-20260115114903384" style="zoom:50%;" />

   阿姆达尔定律

   <img src="C:\Users\18289\AppData\Roaming\Typora\typora-user-images\image-20260115114742557.png" alt="image-20260115114742557" style="zoom:50%;" />

2. 内存性能的评估

   <img src="C:\Users\18289\AppData\Roaming\Typora\typora-user-images\image-20260115115055922.png" alt="image-20260115115055922" style="zoom:50%;" />

3. 利特尔定律如何做、

4. 动态功耗的评估，给你一个，算一下f、k值，应该要会算。工作频率怎么算？

   <img src="C:\Users\18289\AppData\Roaming\Typora\typora-user-images\image-20260115115438606.png" alt="image-20260115115438606" style="zoom:50%;" />

5. 计算机功耗估计、平均功耗。

   <img src="C:\Users\18289\AppData\Roaming\Typora\typora-user-images\image-20260115115549135.png" alt="image-20260115115549135" style="zoom:50%;" />

6. 架构上的一些仿真，有哪些仿真方法，三种仿真方法分别是什么？比如说全系统仿真：模拟整个计算机系统的运行，包含硬件行为

   - functional 仿真：只对指令集架构功能进行建模，主要用于设计验证，可以生成指令调用的堆栈信息
   - trace-drive：将程序执行指令和指令地址输入微体系结构时序模拟器
   - execution-drvie 仿真 功能仿真和时序仿真结合

7. 工作负载设计有哪些

   - 工作负载特征分析
   - 主成分分析PCA
   - 聚类分析kmeans

8. SPEC性能评估，习题要会。练习题——加速比！**第5、7章会考大题。**

9. 给出一道题，cpi是什么？怎么计算？

**第五七章是考试的重点，起码要知道性能分析，性能评估（比如cpi 动态功耗的评估）**

### 2.6 第八章 多处理器系统

1. flynn架构划分方法？
2. 几种常见的多处理器系统架构是？要会区分。考相关的习题，**会更着重地考虑和现在的架构相关的！热点？！**
3. **缓存一致性的问题**，定义，怎么做到的，要求要搞清楚！（第一步和第二步要搞清楚）
4. snooping协议是什么？要会
5. 还有一个**目录协议**，两种协议都要会。（读取失效时目录协议怎么做？一共七步，第二步怎么做？）

**5/7/8章ppt是重点！！我还会回来的！！**

### 2.7 第九章 片上处理器与多核系统

讲并行细节的。

1. 异构多核的分类？
2. 数据并行什么意思？
3. SMT对资源利用率的影响。分析分析
4. 多核的介绍和不同类型，异构多核的分类（如多指令集异构处理器等要搞清楚）
5. 众核和多核的区别？

### 2.8 第十章 数据并行与GPGPU

1. 数据并行、数据并行的两个例子要区分出来 SISD SIMD
2. **向量处理器**的方法架构，向量处理器相关的案例要回分析，给你个公式要会求周期数，相关的例题要考！

1. 
2. 旁路优势，GPGPU是什么？

### 2.9 第十一章 片上互联网络简介

1. 片上网络noc的基础概念，noc网络长什么样，能不能分辨出来？
2. noc、片上网络相关的术语和作用，拓扑结构、互联拓扑等要会（考小知识不考大题）

### 2.10 第十二章 数据中心

1. 数据中心有什么功能、有什么组成设备、概念
2. 什么是能效比、层次化？
3. 电力系统组成，还有电路供给问题、超额、不足、削峰等概念？
4. 冷却系统相关的呢？

